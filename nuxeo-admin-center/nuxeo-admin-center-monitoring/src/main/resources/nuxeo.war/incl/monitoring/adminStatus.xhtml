<div xmlns:h="http://java.sun.com/jsf/html"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:f="http://java.sun.com/jsf/core">


<h2><h:outputText value="#{messages['adminsubtab.monitoring.adminStatus']}" /></h2>

<a4j:outputPanel id="admStatusPanel" ajaxRendered="true">

 <h:panelGroup rendered="#{isMultiServerInstallation}">
  <h:outputText value="#{messages['label.monitoring.multiserver']}" /><br/>
  <h:outputText value="#{messages['label.monitoring.instanceList']}" /><br/>
  <nxu:repeat var="serverName" value="#{monitoringAction.listNuxeoInstances()}">
   <h:outputText value="#{serverName}" /> <br/>
  </nxu:repeat>
 </h:panelGroup>

 <h:panelGroup rendered="#{!isMultiServerInstallation}">
  <h:outputText value="#{messages['label.monitoring.monoserver']}" /><br/>
 </h:panelGroup>


  <h:dataTable var="status" value="#{monitoringAction.getAdministrativeStatuses()}" class="dataOutput"
    rowClasses="dataRowEven,dataRowOdd">
    <h:column>
      <f:facet name="header">
        <h:outputText value="#{messages['label.monitoring.status.label']}" />
      </f:facet>
      <h:outputText value="#{status.label}" />
    </h:column>
    <h:column>
      <f:facet name="header">
      <h:outputText value="#{messages['label.monitoring.status.state']}" />
      </f:facet>
       <h:graphicImage url="/img/state_active.png"
    alt="#{status.state}"  title="#{status.state}" rendered="#{status.isActive()}"/>
       <h:graphicImage url="/img/state_inactive.png"
    alt="#{status.state}" title="#{status.state}" rendered="#{!status.isActive()}"/>
    </h:column>
    <h:column>
      <f:facet name="header">
      <h:outputText value="#{messages['label.monitoring.status.message']}" />
      </f:facet>
      <h:outputText value="#{status.message}" />
    </h:column>
    <h:column>
      <f:facet name="header">
      <h:outputText value="#{messages['label.monitoring.status.description']}" />
      </f:facet>
      <h:outputText value="#{status.description}" />
    </h:column>
    <h:column>
      <f:facet name="header">
      <h:outputText value="#{messages['label.monitoring.status.action']}" />
      </f:facet>

     <h:panelGroup rendered="#{status.isActive()}">
     <h:form>
        <h:inputText value="#{monitoringAction.newStatusMessage}"></h:inputText>
        <a4j:commandButton  value="#{messages['action.monitoring.passivate']}" action="#{monitoringAction.passivateService()}" reRender="admStatusPanel">
            <f:param name="serviceIdentifier" value="#{status.serviceIdentifier}" />
        </a4j:commandButton>
     </h:form>
     </h:panelGroup>
     <h:panelGroup rendered="#{status.isPassive()}">
     <h:form>
        <h:inputText value="#{monitoringAction.newStatusMessage}"></h:inputText>
        <a4j:commandButton  action="#{monitoringAction.activateService()}" reRender="admStatusPanel" value="#{messages['action.monitoring.activate']}" >
            <f:param name="serviceIdentifier" value="#{status.serviceIdentifier}" />
        </a4j:commandButton>
     </h:form>
     </h:panelGroup>
    </h:column>
  </h:dataTable>

</a4j:outputPanel>

</div>