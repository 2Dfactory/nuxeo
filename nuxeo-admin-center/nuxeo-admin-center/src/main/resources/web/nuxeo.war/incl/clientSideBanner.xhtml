<f:subview xmlns:h="http://java.sun.com/jsf/html"
     xmlns:c="http://java.sun.com/jstl/core"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:f="http://java.sun.com/jsf/core">

 <c:choose>
      <c:when test="#{connectUpdateStatusInfo.registered}">

       <c:if test="false"> Instance is registered, but we can not check the status from the server side </c:if>

       <c:if test="#{currentNuxeoPrincipal!=null and currentNuxeoPrincipal.isAdministrator()}">
         <span style="display:none" id="connectExpiredMessageBanner">
          <div class="bannerBottom unregistered">
            <div class="bannerMessage">
              <p style="padding:0px;margin:0px">This application is powered by Nuxeo #{connectUpdateStatusInfo.distributionLabel}. <span class="bold">Nuxeo Connect registration can not be validated.</span>
              <span id="mayBeNeedUpdate">It might be <span class="bold">not up to date.</span></span>
              <span class="bold" id="connectHotFixesCountMsg" style="display:none"><span id="connectHotFixesCount">3</span> hotfix(es) published since this release.</span></p>
            </div>
           <div class="links">
              <a href="mailto:connect-support@nuxeo.com?subject=Issue%20in%20Connect%20contract%20#{connectUpdateStatusInfo.identifier}">Contact connect-support@nuxeo.com to reactivate Nuxeo Connect</a>
           </div>
           <div class="clear" />
          </div>
         </span>

         <script>
         function displayConnectUpdateStatus(registrationStatus) {
           if (registrationStatus.registered!=true) {
                 jQuery(document).ready(function(){
                     if (registrationStatus.nbPkgs>0) {
                       jQuery("#mayBeNeedUpdate").css("display","none");
                       jQuery("#connectHotFixesCount").html(""+registrationStatus.nbPkgs);
                       jQuery("#connectHotFixesCountMsg").css("display","block");
                     }
                     jQuery("#connectExpiredMessageBanner").css("display","block");
                 });
           }
         }
         </script>
         <script src="#{connectUpdateStatusInfo.feedUrl}"></script>
       </c:if>

      </c:when>
      <c:otherwise>

         <c:if test="false"> Instance is not registered </c:if>

         <div class="bannerBottom unregistered" >
           <div class="bannerMessage">
            <p>This application is powered by Nuxeo #{connectUpdateStatusInfo.distributionLabel} and is <span class="bold">not registered in Nuxeo Connect.</span>
            <span id="mayBeNeedUpdate">It might be <span class="bold">not up to date.</span></span>
            <span class="bold" id="connectHotFixesCountMsg" style="display:none"><span id="connectHotFixesCount">3</span> hotfix(es) published since this release.</span></p>
            <p> Enable Nuxeo Connect if you want to register and benefit from automatic maintenance.</p>
           </div>
           <div class="links">
            <a href="http://doc.nuxeo.com/display/NXDOC/Register+your+Nuxeo+instance" target="_blank">How to enable Nuxeo Connect</a>
            <a href="https://connect.nuxeo.com/nuxeo/site/connect/trial/form?source=unregisteredClientBanner&#38;product=#{connectUpdateStatusInfo.distributionLabel}" target="_blank">Subscribe to Nuxeo Connect</a>
           </div>
           <div class="clear" />
        </div>

        <script>
         function displayConnectUpdateStatus(nbPkg) {
                  jQuery(document).ready(function(){
                  if (nbPkg>0) {
                   jQuery("#mayBeNeedUpdate").css("display","none");
                   jQuery("#connectHotFixesCount").html(""+nbPkg);
                   jQuery("#connectHotFixesCountMsg").css("display","block");
                  }
                 });
         }
        </script>

        <script src="#{connectUpdateStatusInfo.feedUrl}"></script>
      </c:otherwise>

 </c:choose>



</f:subview>