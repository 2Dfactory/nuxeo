<component name="org.nuxeo.ecm.core.rules.test-exception-chain" version="1.0">

  <extension point="operations"
             target="org.nuxeo.ecm.core.operation.OperationServiceComponent">
    <operation class="org.nuxeo.ecm.automation.core.test.Operation1"/>
    <operation class="org.nuxeo.ecm.automation.core.test.Operation2"/>
    <operation class="org.nuxeo.ecm.automation.core.test.OperationFailure"/>
    <operation class="org.nuxeo.ecm.automation.core.test.OperationFailureNPE"/>
  </extension>

  <extension point="chains"
             target="org.nuxeo.ecm.core.operation.OperationServiceComponent">

    <chain id="contributedchain">
      <param type="string" name="messageChain"/>
      <operation id="o1">
        <param type="string" name="message">Hello 1!</param>
      </operation>
      <operation id="o2">
        <param type="string" name="message">Hello 2!</param>
      </operation>
      <operation id="operationFailure"/>
    </chain>

    <chain id="chainException">
      <param type="string" name="messageChain"/>
      <operation id="o1">
        <param type="string" name="message">Hello 1!</param>
      </operation>
      <operation id="o2">
        <param type="string" name="message">Hello 2!</param>
      </operation>
    </chain>

  </extension>

  <extension point="chainException"
             target="org.nuxeo.ecm.core.operation.OperationServiceComponent">

    <catchChain id="catchChainA" onChainId="contributedchain">
      <run chainId="chainException" order="0" rollBack="false" filterId="filterA" exception="*"/>
      <run chainId="chainException" order="0" rollBack="false" filterId="filterA" exception="NullPointException"/>
      <run chainId="chainException" order="10" rollBack="true" filterId="filterB"/>
    </catchChain>

  </extension>

  <extension point="automationFilter"
             target="org.nuxeo.ecm.core.operation.OperationServiceComponent">

    <filter id="filterA">expr:@{Document['dc:title']=='Source'}</filter>

    <filter id="filterB">expr:@{Document['dc:title']=='document'}</filter>

  </extension>

</component>
