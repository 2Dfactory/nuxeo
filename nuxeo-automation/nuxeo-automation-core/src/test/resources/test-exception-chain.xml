<component name="org.nuxeo.ecm.core.rules.test-exception-chain" version="1.0">

  <extension point="operations"
             target="org.nuxeo.ecm.core.operation.OperationServiceComponent">
    <operation class="org.nuxeo.ecm.automation.core.test.Operation1"/>
    <operation class="org.nuxeo.ecm.automation.core.test.Operation2"/>
    <!--<operation class="org.nuxeo.ecm.automation.core.test.OperationFailure"/>-->
  </extension>

  <extension point="chains"
             target="org.nuxeo.ecm.core.operation.OperationServiceComponent">
    <chain id="contributedchain">
      <param type="string" name="messageChain"/>
      <operation id="o1">
        <param type="string" name="message">Hello 1!</param>
      </operation>
      <operation id="o2">
        <param type="string" name="message">Hello 2!</param>
      </operation>
      <!--<operation id="operationFailure"/>-->
      <exceptionChain>
        <catchChain id="exceptionA" chainId="chainException" priority="0" rollBack="true">
          expr:@{Document['dc:title']=='document'}
        </catchChain>
        <catchChain id="exceptionB" chainId="chainA" priority="1" rollBack="true">
          expr:@{Document['dc:title']=='document'}
        </catchChain>
        <catchChain id="exceptionC" chainId="chainB" priority="0" rollBack="false">
          expr:@{Document['dc:title']=='file'}
        </catchChain>
      </exceptionChain>
    </chain>
    <chain id="chainException">
      <param type="string" name="messageChain"/>
      <operation id="o1">
        <param type="string" name="message">Hello 1!</param>
      </operation>
      <operation id="o2">
        <param type="string" name="message">Hello 2!</param>
      </operation>
    </chain>
  </extension>

</component>
