<?xml version="1.0"?>
<component name="org.nuxeo.elasticsearch.ElasticSearchComponent" version="1.0">

  <implementation class="org.nuxeo.elasticsearch.ElasticSearchComponent" />

  <service>
      <provide interface="org.nuxeo.elasticsearch.api.ElasticSearchService" />
      <provide interface="org.nuxeo.elasticsearch.api.ElasticSearchIndexing" />
      <provide interface="org.nuxeo.elasticsearch.api.ElasticSearchAdmin" />
  </service>

  <extension-point name="elasticSearchServer">
    <documentation>
      Extension point used to contribute the configuration for Elasticsearch engine.

      There are 3 ways of integrating Nuxeo and Elasticsearch :

      <b>Embedded</b> In this mode, Elasticsearch is deployed inside the same JVM as Nuxeo.

      <code>
       <elasticSearchServer inProcess="true">
         <nodeName>nuxeoTestNode</nodeName>
         <clusterName>nuxeoTestCluster</clusterName>
       </elasticSearchServer>
      </code>

      <b>External : Autostart</b> In this mode, Elasticsearch is supposed to be installed outside of Nuxeo, the Nuxe Server will simply start a new Node.

      <code>
       <elasticSearchServer autostartLocalNode="true">
        <startupScript>/home/tiry/devs/elasticsearch-0.90.2/bin/elasticsearch</startupScript>
        <nodeName>nuxeoTestNode</nodeName>
        <clusterName>nuxeoTestCluster</clusterName>
       </elasticSearchServer>
      </code>

      <b>External : Join</b> In this mode, Elasticsearch is supposed to be installed outside of Nuxeo, the Nuxe Server will simply connect to an already running node.

      <code>
       <elasticSearchServer>
        <hostIO>127.0.0.1</hostIO>
        <hostPort>8001</hostPort>
       </elasticSearchServer>
      </code>

    </documentation>

    <object class="org.nuxeo.elasticsearch.config.ElasticSearchServerConfig" />
  </extension-point>

  <extension-point name="elasticSearchIndex">
    <documentation>
      Extension point used to setup an Elasticsearch index.

      The one used to index Nuxeo documents must be of type "doc".

      <code>
       <elasticSearchIndex name="nuxeo" type="doc" create="true">
         <settings></settings>
         <mapping></mapping>
         <fulltext>
            <field>dc:title</field>
            <field>dc:description</field>
            <field>note:note</field>
         </fulltext>
       </elasticSearchIndex>
      </code>

    name is the Elasticsearch index name.

    type is the Elasticsearch type that hold a mapping, "doc" is the mapping
    for Nuxeo documents

    create can be set to false if you don't want Nuxeo to initialize the index
    and mapping.

    settings the Elasticsearch settings
    @see http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/index-modules.html

    mapping the Elasticsearch mapping for the type
    @see http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/mapping.html

    fulltext/field a list fo Nuxeo field that should be searched as fulltext.

    @Since 5.9.3
    </documentation>

    <object class="org.nuxeo.elasticsearch.config.ElasticSearchIndexConfig" />
  </extension-point>

</component>
