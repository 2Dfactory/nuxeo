<div xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:nxh="http://nuxeo.org/nxweb/html"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  xmlns:nxd="http://nuxeo.org/nxweb/document">

  <h3>
    <h:outputText value="#{messages['label.addToCollection.title']}" />
  </h3>

  <h:form id="#{fancyboxFormId}">

    <div class="content">

      <script>
              function checkNewCollection() {
                alert('toto');
              }
            </script>

      <table class="dataInput fullWidth">
        <tbody>
          <tr>
            <td class="labelColumn required">
              #{messages['label.addToCollection.collection']}</td>
            <td class="fieldColumn"><nxl:widgetType
                name="singleDocumentSuggestion" mode="edit"
                value="#{collectionActions}"
                field="selectedCollectionUid" required="true"
                width="100%" translated="true" minChars="0"
                placeholder="label.addToCollection.collection.placeHolder"
                ajaxReRender="#{fancyboxFormId}_collectionDescriptionsPanel,#{fancyboxFormId}_buttons"
                operationId="Collection.Suggestion"
                selectionFormatter="formatSelectedCollection"
                suggestionFormatter="formatSuggestedCollection"
                documentSchemas="dublincore,common"
                onchange="checkNewCollection">
              </nxl:widgetType></td>
          </tr>
        </tbody>
      </table>

      <a4j:outputPanel
        id="#{fancyboxFormId}_collectionDescriptionsPanel">
        <c:if test="#{collectionActions.isCreateNewCollection()}">
          <table class="dataInput fullWidth">
            <tbody>
              <tr>
                <td class="labelColumn">
                  #{messages['label.addToCollection.collection.description']}</td>
                <td class="fieldColumn"><h:inputTextarea
                    class="dataInputText" id="description"
                    value="#{collectionActions.newDescription}" rows="3"
                    cols="40" /></td>
              </tr>
            </tbody>
          </table>
        </c:if>
      </a4j:outputPanel>

    </div>


    <a4j:outputPanel id="#{fancyboxFormId}_buttons" layout="block">
      <div class="buttonsGadget"></div>
      <nxh:commandButton value="#{messages['command.import']}"
        action="#{collectionActions.addCurrentDocumentToSelectedCollection()}"
        disabled="#{!collectionActions.canAddToSelectedCollection()}"
        styleClass="button" />
      <nxh:commandButton value="#{messages['command.cancel']}"
        immediate="true" action="#{collectionActions.cancel()}"
        styleClass="button" />
    </a4j:outputPanel>
  </h:form>

</div>
