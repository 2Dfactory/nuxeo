<nxthemes:composition xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:nxthemes="http://nuxeo.org/nxthemes"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:nxl="http://nuxeo.org/nxforms/layout">

  <ui:define name="page title">
    <h:outputText value="#{nuxeoApplicationName} - #{messages['title.search.form']}"/>
  </ui:define>

  <ui:define name="body">

    <script language="javascript">
      function updateParent(documentUid, documentTitle) {
        parentInput = opener.document.getElementById('createForm:objectDocumentUid');
        parentInput.value = documentUid;
        parentTitle = opener.document.getElementById('createForm:objectDocumentTitle');
        parentTitle.innerHTML = documentTitle;
        parentTitleSaved = opener.document.getElementById('createForm:objectDocumentTitleSaved');
        parentTitleSaved.value = documentTitle;
        self.close();
      }
    </script>

    <nxu:set var="contentViewName" value="relation_search">
    <nxu:set var="contentViewId" value="0">

      <div>
        <h3><h:outputText value="#{messages['label.search.form.simple']}" /></h3>
        <h:form>
          <nxu:set var="contentView"
            value="#{contentViewActions.getContentViewWithProvider(contentViewName)}"
            cache="true">
            <c:if test="#{contentView != null}">
              <nxl:layout name="#{contentView.searchLayout.name}" mode="search"
                value="#{contentView.searchDocumentModel}" />
            </c:if>

            <h:commandButton value="#{messages['command.search']}"
              action="#{contentViewActions.resetPageProvider(contentViewName)}" class="button"
              id="searchButton" />
          </nxu:set>
        </h:form>
      </div>

      <div id="content">
        <ui:decorate template="/incl/content_view.xhtml">
          <ui:define name="empty_folder_label">
            <h:outputText value="#{messages['label.content.empty.search']}"
              rendered="#{documents.rowCount == 0 and not provider.hasError()}" />
          </ui:define>
          <ui:define name="content_view_header_before_selector">
            <div class="action_bar">
              <h3>
                <h:outputText value="#{messages['label.search.results']}" />
              </h3>
            </div>
          </ui:define>
          <ui:define name="content_view_header_after_selector" />
          <ui:define name="syndication_buttons" />
        </ui:decorate>
      </div>
    </nxu:set>
    </nxu:set>
  </ui:define>

</nxthemes:composition>
