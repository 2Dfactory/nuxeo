<f:subview id="#{widget.id}"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  xmlns:h="http://java.sun.com/jsf/html">

  <c:if test="#{widget.mode == 'edit'}">

    <c:set var="acceptedExtensions" value="#{nxu:test(!empty widgetProperties_acceptedExtensions, widgetProperties_acceptedExtensions, '.jpg, .jpeg, .png, .gif')}" />

    <nxu:inputFile id="#{widget.id}_file" value="#{field}"
      filename="#{field.filename}" required="#{widget.required}" editFilename="false"
      onclick="#{widgetProperty_onclick}" onchange="#{widgetProperty_onchange}">
      <nxu:validateFileMimetype extensions="#{acceptedExtensions}" hidden="true" />
    </nxu:inputFile>
    <h:message styleClass="errorMessage" for="#{widget.id}_file"
      id="#{widget.id}_message" />

  </c:if>

  <c:if test="#{widget.mode != 'edit'}">

    <nxu:set var="image_url"
     value="#{nxd:fileUrl('downloadFile', value, widget.fieldDefinitions[0].propertyName, field.filename)}"
     cache="true">
      <c:if test="#{not empty image_url}">
        <img src="#{image_url}"
          title="#{field.filename}" alt="#{field.filename}"
          width="#{widgetProperties_width}" height="#{widgetProperties_height}" />
      </c:if>
    </nxu:set>

  </c:if>

</f:subview>
