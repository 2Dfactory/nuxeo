<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<nxthemes:composition xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:nxthemes="http://nuxeo.org/nxthemes"
  xmlns:nxl="http://nuxeo.org/nxforms/layout">

  <ui:define name="body">

    <ui:include src="/incl/message_banner.xhtml"/>

    <style>
      .infoView.navigation {
        box-sizing: border-box;
        left: 0;
        padding: 0 1.5em;
        position: fixed;
        right: 0;
        top: 45%;
        width: 66.66%;
        z-index: 200 }

      .infoView.navigation div:first-child,
      .infoView.navigation div:last-child {
        background: url("#{contextPath}/icons/chevron-left.png") no-repeat scroll center center / 80% auto rgba(0, 0, 0, 0.3);
        border-radius: 3px;
        float: left;
        height: 8em;
        width: 2em }

      .infoView.navigation div:last-child {
        background-image: url("#{contextPath}/icons/chevron-right.png");
        float: right }

      .infoView .next,
      .infoView .previous {
        color: transparent;
        display: inline-block;
        height: 8em;
        width: 2em }
    </style>

    <div class="infoView navigation">
      <div>
        <a class="previous" href="#" onclick="previousInfoView(); return false;"></a>
      </div>
      <div>
        <a class="next" href="#" onclick="nextInfoView(); return false;"></a>
      </div>
    </div>

    <nxl:layout value="#{currentDocument}" name="gridInfoViewLayout" mode="view" />

    <script type="text/javascript">
      jQuery(document).ready(function() {
        jQuery("#fancybox-frame", parent.document).attr("allowFullscreen", true);
      });

      function previousInfoView() {
        var urls = parent.nuxeo.infoView.infoViewUrls;
        var currentUrl = [location.protocol, '//', location.host, location.pathname].join('');
        var index = urls.indexOf(currentUrl);
        if (index === 0) {
          // previous page
          parent.nuxeo.infoView.previousPageAndOpenInfoView();
        } else {
          console.log("current url: " + window.location.href);
          console.log("prev url: " + urls[index - 1] + "?conversationId=" + currentConversationId);
          console.log("index of current: " + index);
          console.log(urls);
          window.location.href = urls[index - 1] + "?conversationId=" + currentConversationId;
        }
      }

      function nextInfoView() {
        var urls = parent.nuxeo.infoView.infoViewUrls;
        var currentUrl = [location.protocol, '//', location.host, location.pathname].join('');
        var index = urls.indexOf(currentUrl);
        if (index === urls.length - 1) {
          // next page
          parent.nuxeo.infoView.nextPageAndOpenInfoView();
        } else {
          console.log("current url: " + window.location.href);
          console.log("next url: " + urls[index + 1] + "?conversationId=" + currentConversationId);
          console.log("index of current: " + index);
          console.log(urls);
          window.location.href = urls[index + 1] + "?conversationId=" + currentConversationId;
        }
      }
    </script>
  </ui:define>

</nxthemes:composition>
